/*
 * (C) Copyright ${year} Nuxeo SA (http://nuxeo.com/) and others.
 *
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the GNU Lesser General Public License
 * (LGPL) version 2.1 which accompanies this distribution, and is available at
 * http://www.gnu.org/licenses/lgpl-2.1.html
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 */

(function(){var a;a=angular.module("ngOnboarding",[]),a.provider("ngOnboardingDefaults",function(){return{options:{overlay:!0,overlayOpacity:.6,overlayClass:"onboarding-overlay",popoverClass:"onboarding-popover",titleClass:"onboarding-popover-title",contentClass:"onboarding-popover-content",arrowClass:"onboarding-arrow",buttonContainerClass:"onboarding-button-container",buttonClass:"onboarding-button",showButtons:!0,nextButtonText:"Next &rarr;",previousButtonText:"&larr; Previous",showDoneButton:!0,doneButtonText:"Done",closeButtonClass:"onboarding-close-button",closeButtonText:"X",stepClass:"onboarding-step-info",showStepInfo:!0},$get:function(){return this.options},set:function(a,b){var c,d,e;if("object"==typeof a){e=[];for(c in a)d=a[c],e.push(this.options[c]=d);return e}return this.options[a]=b}}}),a.directive("onboardingPopover",["ngOnboardingDefaults","$sce","$timeout",function(a,b){return{restrict:"E",scope:{enabled:"=",steps:"=",onFinishCallback:"=",index:"=stepIndex"},replace:!0,link:function(c){var d,e,f,g;return e=null,d=["title","top","right","bottom","left","width","height","position"],c.stepCount=c.steps.length,c.next=function(){return c.index=c.index+1},c.previous=function(){return c.index=c.index-1},c.close=function(){return c.enabled=!1,f(!1),c.onFinishCallback?c.onFinishCallback():void 0},c.$watch("index",function(h){var i,j,k,l,m;if(null===h)return c.enabled=!1,void f(!1);for(e=c.steps[c.index],c.lastStep=c.index+1===c.steps.length,c.showNextButton=c.index+1<c.steps.length,c.showPreviousButton=c.index>0,l=0,m=d.length;m>l;l++)i=d[l],c[i]=null;for(j in a)k=a[j],void 0===e[j]&&(c[j]=k);for(j in e)k=e[j],c[j]=k;return c.description=b.trustAsHtml(c.description),c.nextButtonText=b.trustAsHtml(c.nextButtonText),c.previousButtonText=b.trustAsHtml(c.previousButtonText),c.doneButtonText=b.trustAsHtml(c.doneButtonText),c.closeButtonText=b.trustAsHtml(c.closeButtonText),f(),g()}),f=function(a){return null==a&&(a=!0),$(".onboarding-focus").removeClass("onboarding-focus"),a&&e.attachTo&&c.overlay?$(e.attachTo).addClass("onboarding-focus"):void 0},g=function(){var a,b,d,f,g,h,i;return a=e.attachTo,c.position=e.position,h=15,i=15,a&&(c.left||c.right||(d=null,f=null,"right"===c.position?d=$(a).offset().left+$(a).outerWidth()+h:"left"===c.position?f=$(window).width()-$(a).offset().left+h:("top"===c.position||"bottom"===c.position)&&(d=$(a).offset().left),e.xOffset&&(null!==d&&(d+=e.xOffset),null!==f&&(f-=e.xOffset)),c.left=d,c.right=f),c.top||c.bottom||(g=null,b=null,"left"===c.position||"right"===c.position?g=$(a).offset().top:"bottom"===c.position?g=$(a).offset().top+$(a).outerHeight()+i:"top"===c.position&&(b=$(window).height()-$(a).offset().top+i),e.yOffset&&(null!==g&&(g+=e.yOffset),null!==b&&(b-=e.yOffset)),c.top=g,c.bottom=b)),c.positionClass=c.position&&c.position.length?"onboarding-"+c.position:null},c.steps.length&&!c.index?c.index=0:void 0},template:"<div class='onboarding-container' ng-show='enabled'>\n  <div class='{{overlayClass}}' ng-style='{opacity: overlayOpacity}', ng-show='overlay'></div>\n  <div class='{{popoverClass}} {{positionClass}}' ng-style=\"{width: width, height: height, left: left, top: top, right: right, bottom: bottom}\">\n    <div class='{{arrowClass}}'></div>\n    <h3 class='{{titleClass}}' ng-show='title' ng-bind='title'></h3>\n    <a href='' ng-click='close()' class='{{closeButtonClass}}' ng-bind-html='closeButtonText'></a>\n    <div class='{{contentClass}}'>\n      <p ng-bind-html='description'></p>\n    </div>\n    <div class='{{buttonContainerClass}}' ng-show='showButtons'>\n      <span ng-show='showStepInfo' class='{{stepClass}}'>Step {{index + 1}} of {{stepCount}}</span>\n      <a href='' ng-click='previous()' ng-show='showPreviousButton' class='{{buttonClass}}' ng-bind-html='previousButtonText'></a>\n      <a href='' ng-click='next()' ng-show='showNextButton' class='{{buttonClass}}' ng-bind-html='nextButtonText'></a>\n      <a href='' ng-click='close()' ng-show='showDoneButton && lastStep' class='{{buttonClass}}' ng-bind-html='doneButtonText'></a>\n    </div>\n  </div>\n</div>"}}])}).call(this);
